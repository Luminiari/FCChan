@using KupoNuts.RPG;
@using KupoNuts.Utils;
@using NodaTime;
@using NodaTime.Text;

@inject HttpClient Http
@inject IModalService Modal
@inject NavigationManager NavigationManager


<div class="form-row">
	<!-- Name -->
	<div class="form-group col-md-4">
		<label for="eventName">Name</label>
		<input type="text" class="form-control" id="eventName" name="eventName" @bind="this.item.Name" />
	</div>

	<!-- Short description -->
	<div class="form-group col-md-4">
		<label for="eventShortDesc">Description</label>
		<input type="text" class="form-control" id="eventShortDesc" name="eventShortDesc" @bind="this.item.Description" />
	</div>

	<!-- Short description -->
	<div class="form-group col-md-4">
		<label for="eventShortDesc">Cost</label>
		<input type="number" class="form-control" id="eventShortDesc" name="eventShortDesc" @bind="this.item.Cost" />
	</div>
	
</div>

<div class="form-row">
	<!--  Description -->
	<div class="form-group col-md-12">
		<label for="eventDesc">Macro</label>
		<textarea class="form-control" id="eventDesc" name="eventDesc" rows="5" @bind="this.item.Macro"></textarea>
	</div>
</div>

<div class="modal-footer">
	<button type="button" class="btn btn-danger" @onclick="this.OnDelete">Delete</button>
	<div class="flex-fill" />
	<button type="button" class="btn btn-primary" @onclick="this.OnSave">Save</button>
	<button type="button" class="btn btn-secondary" @onclick="this.OnClose">Close</button>
</div>


@code {
	[CascadingParameter]
	ModalParameters Parameters { get; set; }

	public bool IsLoading { get; set; }

	private Item item;

	protected override async Task OnInitializedAsync()
	{
		Authentication.Initialize(this.Http, this.NavigationManager);

		await base.OnInitializedAsync();

		this.item = Parameters.Get<Item>("Item");
	}

	private void OnSave()
	{
		this.Modal.Close(ModalResult.Ok(new DataAction<Item>(this.item, Actions.Update)));
	}

	private void OnClose()
	{
		this.Modal.Close(ModalResult.Ok(new DataAction<Item>(this.item, Actions.Nothing)));
	}

	private void OnDelete()
	{
		this.Modal.Close(ModalResult.Ok(new DataAction<Item>(this.item, Actions.Delete)));
	}
}
